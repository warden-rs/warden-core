syntax = "proto3";

package configuration.typology;

message Workflow {
  double alert_threshold = 1;
  double interdiction_threshold = 2;
}

message TypologyRuleWeight {
  string ref = 1;
  int64 weight = 2;
}

message TypologyRule {
  string id = 1;
  string cfg = 2;
  repeated TypologyRuleWeight wghts = 3;
}

message TypologyConfiguration {
  string id = 1;
  string description = 2;
  string cfg = 3;
  Workflow workflow = 4;
  repeated TypologyRule rules = 5;
}
